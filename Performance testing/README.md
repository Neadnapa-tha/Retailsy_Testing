# Performance Testing

## I. Average-load test

Average-load test เป็นการทดสอบประสิทธิภาพของระบบโดยการให้มีการใช้งานมากขึ้นจนถึงระดับสูงสุดหรือขีดจำกัดที่ระบบสามารถรับได้ ในรูปแบบที่อยู่ในค่าเฉลี่ยการใช้งานปกติของเว็บไซต์ เพื่อตรวจสอบว่าระบบสามารถทำงานได้ดีในสถานการณ์ที่มีการใช้งานมากเพียงพอหรือไม่

โดยมีการทดสอบ ดังนี้
1. สร้าง Script ในการทดสอบระบบโดยเริ่มต้นด้วยการส่งคำขอ 100 request/s เป็นเวลา 3 นาที จากนั้นคงที่ในระดับนั้นไปอีก 10 นาที และสุดท้ายลดลงเป็น 0 request/s เป็นเวลา 3 นาที โดย Code เป็นดังนี้
   
```
     export const options = {
  stages: [
    { duration: "3m", target: 100 }, // เพิ่ม User จาก 1-100 คน ภายใน 3 นาที
    { duration: "10m", target: 100 }, // User 100 คน สามารถตงที่อยู่ในระบบได้ 10 นาที
    { duration: "3m", target: 0 }, // ลด User เหลือ 0 คน
  ]
```

2. ผลลัพธ์ที่ได้ผ่าน K6 metrics

  | Metrics                        | Output  |
  |--------------------------------------------|----|
  | check              | 100 % |
  | durations          | 16m01.1 s |
  | iterations         | 10396     |
  | vus                | 1  |
  | vus_max            | 100     |
  | data_received      | 610 MB  |
  | data_sent          | 884 kB     |
  | http_req_failed    | 0.00 % |
  | http_reqs          | 10396  |
  | http_req_duration  | avg=6.53s, min=104.68ms, med=5.71s, max=29.61s, p(90)=12.62s, p(95)=13.55s     |
    
  
3. รูปภาพ Perfomance Test ของ Average-load Test โดยแสดงผลในรูปของกราฟ
   
  [![avg.png](https://i.postimg.cc/Fss5hbN5/avg.png)](https://postimg.cc/mhq6wHP8)


------------------------------------------------------------------------------------------------------------------------------

## II. Stress testing
Stress testing เป็นการทดสอบประสิทธิภาพโดยให้มีผู้ใช้งานในระบบเป็นจำนวนมากกว่าปกติเป็นระยะเวลาหนึ่ง เพื่อตรวจสอบว่า เว็บไซต์สามารถรองรับกับผู้ใช้งานที่มีมากกว่าปกติได้หรือไม่
1. ทดสอบระบบโดยเริ่มต้นด้วยการส่งคำขอ 200 request/s ภายในเวลา 3 นาที จากนั้นคงที่ในระดับนั้นไปอีก 10 นาที และสุดท้ายลดลงเป็น 0 request/s ภายในเวลา 5 นาที โดย Code เป็นดังนี้

   ```
   export const options = {
   stages: [
    { duration: '2m', target: 100 },  // normal load
    { duration: '3m', target: 200 },  
    { duration: '5m', target: 200 },  // around the breaking point
    { duration: '10m', target: 200 }, 
    { duration: '2m', target: 200 },
    { duration: '5m', target: 0 },    // scale down. Recovery stage.
     ],
   };
   ```
   
2. ผลลัพธ์ที่ได้ผ่าน K6 metrics

  | Metrics                        | Output  |
  |--------------------------------------------|----|
  | check              | 79.61 % |
  | durations          | 26m.50 s  |
  | iterations         | 19026   |
  | vus                | 2 |
  | vus_max            | 200  |
  | data_received      | 890 MB |
  | data_sent          | 1.4 MB |
  | http_req_failed    | 20.38 % |
  | http_reqs          | 19029 |
  | http_req_duration  | avg=9.88s, min=0s, med=4.08s, max=8.96s, p(90)=10.69s, p(95)=52.96s     |


3. รูปภาพ Perfomance Test ของ Stress testing โดยแสดงผลในรูปของกราฟ
   
   [![stress.png](https://i.postimg.cc/Z5Dz0Wj7/stress.png)](https://postimg.cc/FYcBBsM3)

------------------------------------------------------------------------------------------------------------------------------

## III. Soak testing
Soak testing เป็นการทดสอบประสิทธิภาพโดยนั้นไปที่การให้มีผู้ใช้งานในระบบมีจำนวนปกติ โดยที่ระยะเวลาในการทดสอบยาวนานขึ้น เพื่อตรวจสอบประสิทธิภาพของเว็บไซต์ ในการรองรับผู้ใช้งานเป็นระยะเวลานาน
1. สร้าง Script ในการทดสอบโดยให้ VUS เพิ่มขึ้นจาก 0 ไป 100 VUS ภายในเวลา 5 นาที จากนั้นให้คงค่าไว้ที่ 100 เป็นเวลา 1 ชั่วโมง และสุดท้ายลดลงเป็น 0 VUS ภายในเวลา 5 นาที โดย Code เป็นดังนี้
   
```
     export const options = {
  stages: [
    { duration: '2m', target: 100 }, //ramp up to 100 in 2 minute
    { duration: '1h', target: 100 }, //stay at 100 fors 1 hours
    { duration: '2m', target: 0 }, // scale down to 0  in 2 minute
  ],
};
```

2. ผลลัพธ์ที่ได้ผ่าน K6 metrics

  | Metrics                        | Output  |
  |--------------------------------------------|----|
  | check              | 100 % |
  | durations          |  1h04m|
  | iterations         |   55602 |
  | vus                | 1 |
  | vus_max            |  100   |
  | data_received      | 3.2 GB |
  | data_sent          |  4.6 MB   |
  | http_req_failed    | 0.00 % |
  | http_reqs          | 54342 |
  | http_req_duration  | avg=6.95s min=1.12s med=6.75s max=1m0s p(90)=8.81s p(95)=11.56s   |

    
3. รูปภาพ Perfomance Test ของ Soak testing โดยแสดงผลในรูปของกราฟ

[![soak.png](https://i.postimg.cc/jjXNzrwF/soak.png)](https://postimg.cc/CZRzgX4G)

------------------------------------------------------------------------------------------------------------------------------

## IV. Spike testing

Spike testing เป็นการทดสอบประสิทธิภาพที่มุ่งเน้นทดสอบโดยการเพิ่มปริมาณการใช้งานอย่างรวดเร็วและหนักมากในระบบในระยะเวลาที่สั้น ๆ โดยมีวัตถุประสงค์เพื่อตรวจสอบว่าระบบสามารถรับมือกับการกระทำที่มีความแปรปรวนได้, หรือทำงานได้ดีในสภาวะที่มีการเพิ่มขึ้นอย่างรวดเร็ว โดยไม่ทราบล่วงหน้า.

โดยมีการทดสอบ ดังนี้

1. สร้าง Script ในการทดสอบ โดยให้ VUS เริ่มต้นจาก 1 และเพิ่มขึ้นเป็น 50 VUS ภายในเวลา 10 วินาที จากนั้นให้เพิ่มขึ้นไปอีกเป็น 500 VUS ภายในเวลา 2 นาที และลดลงมาเหลือ 100 ภายในเวลา 30 วินาที ลดลดมาอีกให้อยู่ในระดับ 10 VUS ภายในเวลา 30 วินาที และสุดท้ายลดลงเหลือ 0 VUS ภายในเวลา 10 วินาที โดย Code เป็นดังนี้
  
```
export const options = {
  stages: [
    { duration: '10s', target: 50 },  // เพิ่ม User จาก 1 ไป 50 คนภายในเวลา 50 วินาที
    { duration: '2m', target: 500 }, // เพิ่ม User จาก 50 ไป 500 ภายในเวลา 2 นาที
    { duration: '1m', target: 100 }, // ลด User จาก 500 เหลือ 100 ภายในเวลา 1 นาที
    { duration: '30s', target: 10 }, // ลด User จาก 100 เหลือ 10 ภายในเวลา 30 วินาที
    { duration: '10s', target: 0 }, // ลด User ให้เหลือ 0 ภายในเวลา 10 วินาที
  ],
};
```
  
2. ผลลัพธ์ที่ได้ผ่าน K6 metrics

  | Metrics                        | Output  |
  |--------------------------------------------|----|
  | check              | 82.34 % |
  | durations          | 3m56.3 s |
  | iterations         | 3412     |
  | vus                | 1  |
  | vus_max            | 500     |
  | data_received      | 165 MB  |
  | data_sent          | 276 kB     |
  | http_req_failed    | 17.65 % |
  | http_reqs          | 3415  |
  | http_req_duration  | avg=14.11s, min=0s, med=9.59s, max=1m0s, p(90)=59.99s, p(95)=59.99s    |
  

3. รูปภาพ Perfomance Test ของ Spike testing โดยแสดงผลในรูปของกราฟ
   
[![spike.png](https://i.postimg.cc/CxtMXryx/spike.png)](https://postimg.cc/NK6wr4f3)

------------------------------------------------------------------------------------------------------------------------------

## ผลลัพธ์ของ Performance Testing 

[![all.png](https://i.postimg.cc/RFdk5q3L/all.png)](https://postimg.cc/sQB65j4M)

จากรูปแสดงถึงกราฟผลลัพธ์ที่ได้ของ Performance Testing ทั้งหมด เมื่อนำการทดสอบ Performance ทั้ง 4 รูปแบบมารวมเข้าด้วยกัน
โดยจะเห็นได้ว่า 
1. Average-load test ได้ทำการทดสอบโดยกำหนดให้ผู้ใช้มีจำนวน 100 คน (Average) และผลลัพธ์คือระบบสามารถรองรับผู้ใช้ที่เข้ามาใช้งานพร้อม ๆ กันจำนวน 100 คนได้
2. Stress Test ได้ทำการทดสอบโดยเพิ่มผู้ใช้จนถึงระดับ 200 คน(สูงกว่าค่า Average) เพื่อทดสอบเว็บไซต์ว่าสามารถรองรับผู้ใช้งานมากกว่าปกติได้หรือไม่
3. Soak Test ได้ทำการทดสอบโดยกำหนดให้มีผู้ใช้มีจำนวน 100 คน(Average) คนในระบบเป็นเวลา 1 ชั่วโมง เพื่อทดสอบว่าเว็บไซต์สามารถรองรับผู้ใช้งานในระดับปกติในระยะเวลาที่นานขึ้นได้หรือไม่
4. Spike Testing มีการเพิ่มจำนวนผู้ใช้ไปจนถึงระดับ 500 ก่อนจะลดลงมา ทดสอบเพื่อดูว่าเว็บไซต์สามารถรองรับจำนวนคนที่เพิ่มขึ้นอย่างรวดเร็วได้หรือไม่
